<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Idéias sobre desenvolvimento iOS">

    <title>UICollectionView - Uma nova abordagem de TableView? - iDeas</title>

    <link rel="canonical" href="http://nobre84.github.io/collectionview/2016/03/02/collectionview-uma-nova-abordagem-de-tableviews/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://nobre84.github.io/feed.xml" title="" />

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74878752-1', 'auto');
  ga('send', 'pageview');

</script>
</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">iDeas</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/viniciuscarvalho/background-header.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>UICollectionView - Uma nova abordagem de TableView?</h1>
                    
                    <h2 class="subheading">Por onde começar a utilizar collectionview</h2>
                    
                    <span class="meta">Postado por Vinicius Carvalho em 2/03/2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=UICollectionView - Uma nova abordagem de TableView?&url=http://nobre84.github.io/collectionview/2016/03/02/collectionview-uma-nova-abordagem-de-tableviews/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://nobre84.github.io/collectionview/2016/03/02/collectionview-uma-nova-abordagem-de-tableviews/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://nobre84.github.io/collectionview/2016/03/02/collectionview-uma-nova-abordagem-de-tableviews/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://nobre84.github.io/collectionview/2016/03/02/collectionview-uma-nova-abordagem-de-tableviews/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>
                
				<blockquote>
  <p>Olá pessoal, essa é minha primeira postagem aqui no EquinociOS e então farei uma breve apresentação. Me chamo <a href="www.twitter.com/viniciusc70">Vinicius Carvalho</a>, sou desenvolvedor mobile há pouco mais de três anos e já trabalhei com backend usando Ruby on Rails. Feita essa introdução, vamos ao que interessa: UICollectionView!</p>
</blockquote>

<p>Vamos estruturar o artigo em quatro partes:</p>

<ul>
  <li>O que é uma CollectionView;</li>
  <li>Como funciona;</li>
  <li>Elementos de uma CollectionView;</li>
  <li>Utilização em diversos aplicativos;</li>
</ul>

<p>Este post contém uma base para você começar a utilizar <code class="highlighter-rouge">UICollectionView</code> em suas aplicações. Não é um guideline, pois a Apple tem um muito bom <a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UICollectionView_class/">Documentação CollectionView</a>. Vou apenas tentar dar um norte com as dificuldades que tive recentemente.</p>

<p><code class="highlighter-rouge">UICollectionView</code> foi introduzido no iOS 6 e, ao longo desse tempo, tornou-se um dos elementos de UI mais apreciados e utilizados por desenvolvedores iOS. Sua característica básica é de um layout em formato de Grid, o que se parece muito com o elemento <code class="highlighter-rouge">GridView</code> do Android.</p>

<p><img src="/img/viniciuscarvalho/layout-flow-cv.png" alt="" /></p>

<p>A gama de aplicações feitas com CollectionViews é vasta e podemos observar nos próprios aplicativos da Apple como calendário, a câmera, música, a própria App Store, entre outros.</p>

<p>Como na <code class="highlighter-rouge">UITableView</code>, a <code class="highlighter-rouge">UICollectionView</code> é uma subclasse de <code class="highlighter-rouge">UIScrollView</code> que gerencia todos os artigos e elementos encomendados. Os itens são geridos por um <em>data source</em>, que fornece uma <em>collection view cell</em>, que representa um elemento em um determinado <em>index path</em>.</p>

<p>Ao contrário da <code class="highlighter-rouge">UITableView</code>, a <code class="highlighter-rouge">UICollectionView</code> não está restrita a um layout vertical, de coluna única. Ao invés disso, a collection view tem um <em>layout object</em>, que determina a posição de cada <em>subview</em>, similar ao <em>data source</em> em alguns aspectos.</p>

<p>Veremos como o <code class="highlighter-rouge">UICollectionViewDataSource</code> (número de itens, seções, cells, …) e <code class="highlighter-rouge">UICollectionViewDelegate</code> são eficientes, a separação do layout da camada de model, que é a grande diferença para as <code class="highlighter-rouge">UITableView</code>s, onde não possui esses layout objects.
Além disso tudo, a customização das células é um ponto importante com as subclasses de <code class="highlighter-rouge">UICollectionViewCell</code>. Possuem diferentes métodos de seleção das células e diferentes modos de animação.
Veremos quase tudo sobre <code class="highlighter-rouge">UICollectionView</code>. O nosso amigo Rodrigo Borges também vai explorar mais esse elemento aqui no blog e nos trazer muito conhecimento.</p>

<h3 id="como-funciona-a-collection-view">Como Funciona a Collection View</h3>

<p>Como mostrado anteriormente, podemos ter o layout simples dividido em colunas e mostrado como default ou podemos explorar a flexibilidade e criar um layout customizado da collection view. Vamos abordar um pouco dessas customizações:
Vou criar um projeto para ilustrar bem essas funcionalidades.</p>

<p>Ao criarmos o projeto temos a seguinte estrutura de arquivos,</p>

<center><img src="/img/viniciuscarvalho/imagem-inicial.png" alt="" /></center>

<p>Foi criado um novo <code class="highlighter-rouge">Controller</code>, <code class="highlighter-rouge">HomeViewController</code>, para receber as instruções da nossa CollectionView. Feito isso vamos trabalhar um pouco no nosso Storyboard.</p>

<p>Nossa Storyboard está estruturada da seguinte forma:</p>

<p><img src="/img/viniciuscarvalho/storyboard-inicial.png" alt="" /></p>

<p>Explicando melhor a figura acima, primeiro criamos um View Controller e colocamos uma <code class="highlighter-rouge">View</code>. Como imagem de fundo, foi inserido um <code class="highlighter-rouge">UIImageView</code> para ocupar toda a tela, com as Constraints de 0,0,0,0.
Em seguida foi adicionado um Visual Effect with Blur em cima da imagem, com a aparência Light. Por cima de tudo isso foi finalmente adicionado o nosso CollectionView. A View terá o tamanho de 600 Width e 480 Height, o tamanho da <code class="highlighter-rouge">cell</code> será de 200 Width e 380 Height, Min Spacing de 10 For Cells e 20 For Lines, Section Insets 20 para esquerda e direita.</p>

<p>Normalmente o scroll das CollectionViews é para baixo. Vamos fazer diferente e aproveitar tudo de customização e fazer o scroll lateral.</p>

<center><img src="/img/viniciuscarvalho/direcao-scroll.png" alt="" /></center>

<p>Feito isso, vamos para a customização do interior da nossa célula. Vamos adicionar uma imagem dentro dela e seus Constraints 0,0,0,0.</p>

<p><img src="/img/viniciuscarvalho/nova-customizacao.png" alt="" /></p>

<p>Depois, vamos adicionar outro efeito Blur no canto inferior da <code class="highlighter-rouge">ImageView</code> e adicionar seus Constraints também.</p>

<center><img src="/img/viniciuscarvalho/constraints-segunda-img.png" alt="" /></center>

<p>Logo em seguida, adicionamos uma Label dentro do Visual Effect Blur e seus respectivos paddings nos quatro cantos: superior, trailing à direita/esquerda e bottom.
Um fato extremamente importante é não esquecer de ligar os Outlets da CollectionView ao nosso <code class="highlighter-rouge">HomeViewController</code> ou referenciá-los via código no nosso <code class="highlighter-rouge">viewDidLoad()</code>. Atenção a este ponto.</p>

<p>Feito tudo isso, vamos finalmente para o código. UFA!</p>

<p>Primeiro vamos abordar nosso <code class="highlighter-rouge">HomeViewController</code>,</p>

<p>```swift
import UIKit</p>

<p>class HomeViewController: UIViewController, UICollectionViewDataSource, UICollectionViewDelegate {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//MARK: - IBOutlets

@IBOutlet weak var backgroundImage: UIImageView!
@IBOutlet weak var collectionView: UICollectionView!
   
//MARK: - UICollectionViewDataSource

private var interests = Interest.createInterests()

override func viewDidLoad() {
    super.viewDidLoad()
    
}

//MARK: - CollectionView

func numberOfSectionsInCollectionView(collectionView: UICollectionView) -&gt; Int {
    return 1
}

func collectionView(collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int {
    return interests.count
}

func collectionView(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath) -&gt; UICollectionViewCell {
    
    let cellIdentifier = "InterestCell"
    
    let cell = collectionView.dequeueReusableCellWithReuseIdentifier("InterestCell", forIndexPath: indexPath) as! InterestCollectionViewCell
    
    cell.interest = self.interests[indexPath.item]
    
    return cell
} }
</code></pre>
</div>

<p>```</p>

<p>Veja que na <code class="highlighter-rouge">CollectionView</code> também temos elementos semelhantes do <code class="highlighter-rouge">UITableView</code>, como <code class="highlighter-rouge">numberOfSections</code>, <code class="highlighter-rouge">numberOfItems</code> e o tratamento da célula. Isso tudo facilita sua compreensão ao trabalhar com <code class="highlighter-rouge">CollectionView</code>.</p>

<p>Foi criada a variável <code class="highlighter-rouge">interests</code>, para pegar os dados e popular nossas células. Além disso, não podemos esquecer de referenciar a sua célula que esteja trabalhando. No nosso caso é o <code class="highlighter-rouge">InterestCell</code>.</p>

<p>Para popularmos nossas células, foi criado o Model <code class="highlighter-rouge">Interest</code>:</p>

<p>```swift
class Interest {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var title = ""
var description = ""
var numberOfMembers = 0
var numberOfPosts = 0
var featuredImage: UIImage!

init(title: String, description: String, featuredImage: UIImage!) {
    self.title = title
    self.description = description
    self.featuredImage = featuredImage
    numberOfMembers = 1
    numberOfPosts = 1
}

static func createInterests() -&gt; [Interest] {
    
    return [
        Interest(title: "Quero viajar o mundo inteiro", description: "Estamos planejando fazer uma eurotrip nas férias deste ano, vamos passar por todo o leste europeu", featuredImage:UIImage(named: "img2")!),
        Interest(title: "Estou trabalhando muito!", description: "Passei esta semana trabalhando mais de oito horas por dia, foi extremamente exaustivo. Que semana!", featuredImage: UIImage(named: "img5")!),
        Interest(title: "Precisamos de desenvolvedores", description: "Estamos criando uma startup com um produto revolucionário e estamos contratando devs que queiram participar desta jornada, basta enviar o portifólio e pretensão salarial", featuredImage: UIImage(named: "img6")!),
        Interest(title: "Dev iOS", description: "Procuramos um desenvolvedor iOS sênior, com mais de 3 anos de experiência e seja muito f***", featuredImage: UIImage(named: "img4")!),
        Interest(title: "Quero me tornar um empreendedor", description: "No Brasil é bem difícil se tornar um empreendedor e abrir seu próprio negócio e por isso vamos te ajudar a desmitificar essa ideia", featuredImage: UIImage(named: "img3")!),
    
    ]
} } ```
</code></pre>
</div>

<p>E por último, na nossa aplicação, temos a <code class="highlighter-rouge">InterestCollectionViewCell</code>,</p>

<p>```swift
class InterestCollectionViewCell: UICollectionViewCell {</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var interest: Interest! {
    didSet {
        updateUI()
    }
}

//MARK: - Private
@IBOutlet weak var featuredImageView: UIImageView!
@IBOutlet weak var interestTitleLabel: UILabel!

private func updateUI() {
    interestTitleLabel?.text! = interest.title
    featuredImageView?.image! = interest.featuredImage
} } ``` Veja que fizemos um tratamento do label e da image, mas caso não queira pode apenas adicionar as propriedades de `IBOutlet` normalmente.
</code></pre>
</div>

<h3 id="elementos-de-uma-collectionview">Elementos de uma CollectionView</h3>

<p>Passado todo o nosso projeto, tem mais algumas coisas interessantes que podemos fazer com os <em>CustomLayouts</em> das <code class="highlighter-rouge">UICollectionView</code>s.
Caso você queira inserir um <em>fade-in</em> ou <em>fade-out</em> em uma célula, você pode customizar completamente o modo de inserção. Por exemplo, podemos inicializar o <em>alpha</em> como 0, que pode se encontrado na barra lateral da direita caso você esteja usando o Storyboard. Isso irá criar uma animação de <em>fade-in</em>. Colocando a translação e escala com os mesmo valores e ao mesmo tempo, deixará com que a célula aumente de tamanho, assim dando aquela sensação de que ela está vindo por cima da outra.
Este mesmo princípio é usado para deletar alguma célula. Agora a animação vai sair do estado normal para o final de acordo com o layout attributes que você irá implementar. Vamos listar alguns métodos que servem para sua customização:</p>

<p>*<code class="highlighter-rouge">initialLayoutAttributesForAppearingItemAtIndexPath:</code>
*<code class="highlighter-rouge">initialLayoutAttributesForAppearingSupplementaryElementOfKind:atIndexPath:</code>
*<code class="highlighter-rouge">initialLayoutAttributesForAppearingDecorationElementOfKind:atIndexPath:</code>
*<code class="highlighter-rouge">finalLayoutAttributesForDisappearingItemAtIndexPath:</code>
*<code class="highlighter-rouge">finalLayoutAttributesForDisappearingSupplementaryElementOfKind:atIndexPath:</code>
*<code class="highlighter-rouge">finalLayoutAttributesForDisappearingDecorationElementOfKind:atIndexPath:</code></p>

<h4 id="trocando-de-layouts">Trocando de layouts</h4>

<p>Para fazer a troca animada de layouts entre collection view, teremos mais ou menos o mesmo conceito anterior de <em>fade in</em> e <em>fade out</em>. Quando chamamos o método <code class="highlighter-rouge">setCollectionViewLayout:animated</code>, ele irá consultar o novo layout e suas células, fazendo assim a animação em cada célula do seu antigo para o novo layout. Você não precisa fazer mais nada. Bem legal, né?</p>

<h3 id="concluses">Conclusões</h3>

<p>Bem falado isso tudo, tentei abordar um pouco de como comecei com as <code class="highlighter-rouge">CollectionView</code> e o que podemos aproveitar desta classe. O nosso amigo <a href="http://www.twitter.com/rdgborges">Rodrigo Borges</a> vai abordar este assunto mais afundo, então aqui foi apenas uma introdução :)
O link do projeto completo está no meu <a href="www.github.com/viniciuscarvalho">github</a>, então se quiser discutir alguma alteração ou propor alguma mudança, será sempre bem-vindo.</p>

<p>Vou deixar alguns links interessantes e que me ajudaram bastante. Um deles foi o <a href="http://invariante.com">Invariante</a> dos amigos <a href="http://www.twitter.com/diogot">Diogo Tridapalli</a> e <a href="http://www.twitter.com/brunokoga">Bruno Koga</a> que tem um artigo interessante também falando sobre uma implementação de <code class="highlighter-rouge">UICollectionView</code> e outros mais. Vale a pena dar uma conferida.</p>

<p>Um abraço e até a próxima!</p>

<p>Links interessantes:</p>

<p><a href="https://developer.apple.com/videos/play/wwdc2015-225/">Talk WWDC’15</a></p>

<p><a href="http://www.raywenderlich.com/107439/uicollectionview-custom-layout-tutorial-pinterest">Ray Wenderlich - tutorial CollectionView Pinterest</a></p>

<p><a href="https://www.youtube.com/watch?v=_490cFFGDjw">Tutorial Ray Wenderlich</a></p>

<p><a href="https://www.youtube.com/watch?v=cCAfeTqsE_Y">Jared Davidson</a></p>

<p><a href="https://www.objc.io/issues/3-views/collection-view-layouts/#animation">objc-io</a></p>

<p><a href="https://ashfurrow.com/uicollectionview-the-complete-guide/">Ash Furrow</a></p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/ios/2016/03/01/ios-web-e-json-sem-dependencias/" data-toggle="tooltip" data-placement="top" title="Resolvendo suas dependências">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/tutorial/2016/03/03/scenekit-overview/" data-toggle="tooltip" data-placement="top" title="SceneKit Overview">Próximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */
                        
                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//nobre84.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/nobre84">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/nobre84">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/nobre84">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:nobre84@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted"><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Licença Creative Commons" style="border-width:0; display: inline;" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />Este obra está licenciado com uma Licença <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Atribuição-NãoComercial 4.0 Internacional</a>.</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
